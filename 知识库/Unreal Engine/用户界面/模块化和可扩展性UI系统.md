**虚幻引擎中创建【模块化】和【可扩展性 UI 系统】-14种最佳实践技巧**

# UI优化相关

- 检查频繁调用创建Widget函数
    
- 检查每帧有多少控件可见|检查有多少控件可测试
    
- 检查控件结构的嵌套程度
    
- 检查用于UI的纹理大小
    
- ......等其他因素
    

一切都取决于实际开发需要

  

如果以控件设置参数后未更新,请重新加载资产(重启也行)

---

推荐使用事件机制,而不是函数|属性绑定.(以下相关)

# 1. 创建基础可重用控件
    

为基础的控件创建派生类

例如**按钮,文本,边框等**

例如文本控件,可以方便的通过父控件来控制文本颜色,文本字体样式

  

  

# 2. 使用命名槽进行模板化
    

![[Pasted image 20250426001128.png]]

在控件中能共享,并且相似的部分,也包含变化的部分.

例如在一个菜单控件内.拥有相似的布局,只是文字等不同

![[Pasted image 20250426001138.png]]

例如上图,这个控件实现类似于三段式结构,拥有Head,Body,FootBody

命名槽支持放入其它控件,使用任何内容重载这个模版

  

  

# 3. 使用不同的层来管理屏幕和控件
    

类似于Lyra的UI管理器,使用UI管理器

引申出[Common UI Plugin](https://jsgqfsm5h1r9.sg.larksuite.com/wiki/TotEwepzsiQ3ZvkoPzBly7WDggb)

层是控件的堆栈,允许弹出和推入控件

![[Pasted image 20250426001202.png]]

这个控件内,拥有四个层

1. 游戏层,用于始终可见的HUD控件
    
2. 游戏菜单层,用于游戏菜单
    
3. 菜单层,用于不属于游戏玩法的菜单,例如暂停和设置菜单
    
4. 模态层,用于弹出窗口和对话框
    

UI管理器封装层,并且公开了其函数,以允许创建或者删除控件

UI管理器可以是子系统,蓝图函数库或者其他东西

层之间未知

**不懂就复制下来问AI**

  

# 4. 把数据放入单独的Object内
    

如何在游戏代码和UI之间传递数据

MVC模式,使用控制器来解决数据传输的问题.

使用事件来解决数据传输的问题

引申出[Common UI Plugin](https://jsgqfsm5h1r9.sg.larksuite.com/wiki/TotEwepzsiQ3ZvkoPzBly7WDggb)

[UMG View Modal Plugin](https://jsgqfsm5h1r9.sg.larksuite.com/wiki/MBE6whQ5FiGizCkoFKMlMrCAg8b)

  

---

优化技巧(以下相关)

# 1. 使用UI失效框
    

缓存不会每帧变化的控件,直到布局失效.而不是每帧计算

例如血条不需要每帧变化或重绘

失效框缓存其布局,并仅在控件更改任何属性时更新

  

# 2. 使用材质进行动画
    

在Widget上使用动画,一般是通过Sequence进行动画,但是Sequence是在CPU上进行运行,且能力有限

使用材质实例进行动画,在GPU上运行,可以处理更复杂的计算.允许更高级的动画而不必添加更多控件或纹理

例如循环动画,粒子效果,发光效果等

前文提到的失效框,使用材质实例并且使用Sequence控制材质参数,并不会使其布局失效

  

# 3. 将控件按类别拆分以进行构建
    

控件应该进行创建|销毁,还是隐藏|显示?

同时使用这两个方法,一切还是取决于实际需要.

- 任何需要快速响应时间的控件.即使是未显示也需要在后台加载.例如库存控件使用非常频繁,所以保持其加载但不可见是最好的方案.
    
- 长时间不存在且不需要快速响应的控件.则选择创建|销毁的方案.在需要的时候异步加载.在关闭时销毁
    

  

# 4. 使用折叠而不是隐藏
    

在控件中,使用隐藏还会使控件布局存在

使用**折叠是唯一完全忽略的选项**

  

# 5. 使用不可测试而不是可见
    

对于不可交互的组件使用不可测试.

可见选项会绘制测试网格,以运行点击交互他们

  

# 6. 谨慎使用画布面板和覆盖
    

因为画布会使用更多的**绘制调用.**

尝试使用**网格面板**替代.

  

# 7. 尽可能使用间隔器而不是尺寸框
    

在控件之间填充空间,请使用间隔器

尺寸框使用资源比间隔器高

  

# 8. 使用软引用
    

比如角色选择控件内,存储了一个角色数组,那么关于这个角色的所有都会被加载到内存中.

所以解决这个的办法就是使用软引用,当需要的时候再加载

  

# 9. 考虑自定义的图标字体(极端优化)
    

在字体样式里面自定义需要的图标,在UI里面使用字体资源而不是UI纹理之类的.

  

# 10. 考虑使用网格控件(极端优化)
    

对于大量相同控件的实例,比如血条,图标等

不太流行的方式:叫网格控件的控件

将静态网格绑定到网格控件

通过Slate Vector Art实现,Float4向量,其中XY是屏幕位置,Z是缩放,W是Address(基地址)

在网格控件中,使用绘制网格函数和启用实例化函数

  

# 使用UI Manager(UI管理器)

使用UI管理器,来管理,UI之间的层次关系.

分为许多层,管理控件的Z轴,优先级等

使用类似于栈或者队列的数据结构,进行控件的焦点,输入焦点等管理